---
sidebar_position: 1
---

# Backend Getting Started

Learn how to develop with the Boards Python backend SDK.

## Overview

The Boards backend is built with:

- **FastAPI** - Modern, fast web framework for building APIs
- **Strawberry GraphQL** - Code-first GraphQL library with Python type hints
- **SQLAlchemy 2.0** - Python SQL toolkit and ORM
- **PostgreSQL** - Relational database with JSON support
- **Redis** - In-memory cache and job queue
- **Pydantic** - Data validation using Python type annotations

## Project Structure

```
packages/backend-sdk/
â”œâ”€â”€ migrations/
â”‚   â”œâ”€â”€ schemas/          # SQL DDL source files (edit these)
â”‚   â”œâ”€â”€ generated/        # Auto-generated migration scripts
â”‚   â””â”€â”€ migration_runner.py
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ generate_models.py    # SQL â†’ SQLAlchemy models  
â”‚   â””â”€â”€ generate_migration.py # Schema diff â†’ migrations
â”œâ”€â”€ src/boards/
â”‚   â”œâ”€â”€ api/              # FastAPI application
â”‚   â”œâ”€â”€ database/         # Database models and connection
â”‚   â”œâ”€â”€ graphql/          # GraphQL schema and resolvers
â”‚   â”œâ”€â”€ providers/        # Provider implementations
â”‚   â”œâ”€â”€ generators/       # Generator implementations
â”‚   â”œâ”€â”€ storage/          # Storage backends
â”‚   â””â”€â”€ config.py         # Configuration management
â””â”€â”€ tests/
```

## Development Workflow

### 1. Environment Setup

```bash
cd packages/backend-sdk

# Create virtual environment
uv venv
source .venv/bin/activate  # On Windows: .venv\Scripts\activate

# Install dependencies
uv pip install -e ".[dev]"
```

### 2. Configuration

Copy the example environment file:

```bash
cp .env.example .env
```

Key configuration options:

```bash
# Database
BOARDS_DATABASE_URL=postgresql://boards:boards_dev@localhost/boards_dev

# Redis
BOARDS_REDIS_URL=redis://localhost:6379/0

# Storage
BOARDS_STORAGE_PROVIDER=local
BOARDS_STORAGE_LOCAL_PATH=./uploads

# Authentication
BOARDS_AUTH_PROVIDER=supabase
BOARDS_AUTH_SUPABASE_URL=your_supabase_url
BOARDS_AUTH_SUPABASE_SERVICE_KEY=your_service_key
```

### 3. Start Development Server

```bash
# Using uvicorn directly
uvicorn boards.api.app:app --reload --port 8000

# Or using the module
python -m boards.api.app
```

The API will be available at:
- **REST API**: http://localhost:8000
- **GraphQL**: http://localhost:8000/graphql
- **Health Check**: http://localhost:8000/health

## Database Development

### Schema-First Approach

Boards uses a **SQL DDL-first migration system** where:

1. **SQL files** are the source of truth
2. **SQLAlchemy models** are auto-generated
3. **Migrations** are auto-generated by comparing schemas

### Making Schema Changes

```bash
# 1. Edit schema files
vim migrations/schemas/002_add_feature.sql

# 2. Generate migration scripts  
python scripts/generate_migration.py --name add_feature

# 3. Apply migration
psql boards_dev < migrations/generated/*_add_feature_up.sql

# 4. Regenerate models
python scripts/generate_models.py
```

ðŸ“– **See [Database Migrations](../backend/migrations) for detailed workflow**

## GraphQL API

### Type Definitions

GraphQL types are defined using Strawberry with Python type hints:

```python
# src/boards/graphql/types/user.py
import strawberry
from typing import List, Optional

@strawberry.type
class User:
    id: strawberry.ID
    email: str
    display_name: str
    avatar_url: Optional[str] = None
    boards: List["Board"] = strawberry.field(resolver=resolve_user_boards)
```

### Resolvers

```python
# src/boards/graphql/resolvers/user.py
from typing import List
from boards.database.models import User, Board

def resolve_user_boards(user: User, info) -> List[Board]:
    return user.boards
```

### Queries and Mutations

```python
# src/boards/graphql/queries/user.py
@strawberry.type
class UserQuery:
    @strawberry.field
    def user(self, id: strawberry.ID) -> Optional[User]:
        return get_user_by_id(id)

@strawberry.type  
class UserMutation:
    @strawberry.mutation
    def update_user(self, id: strawberry.ID, input: UserInput) -> User:
        return update_user(id, input)
```

## Provider System

### Creating a Provider

```python
# src/boards/providers/my_provider.py
from boards.providers.base import BaseProvider
from typing import Dict, Any, AsyncGenerator

class MyProvider(BaseProvider):
    name = "my_provider"
    
    async def generate_image(
        self, 
        prompt: str, 
        params: Dict[str, Any]
    ) -> AsyncGenerator[Dict[str, Any], None]:
        # Implementation here
        yield {"status": "processing", "progress": 50}
        yield {"status": "completed", "output": {"url": "..."}}
```

### Registering Providers

```python
# src/boards/providers/__init__.py
from .replicate import ReplicateProvider
from .my_provider import MyProvider

PROVIDERS = {
    "replicate": ReplicateProvider,
    "my_provider": MyProvider,
}
```

## Testing

### Running Tests

```bash
# Run all tests
python -m pytest

# Run with coverage
python -m pytest --cov=boards --cov-report=html

# Run specific test file
python -m pytest tests/test_api.py

# Run with verbose output
python -m pytest -v
```

### Writing Tests

```python
# tests/test_providers.py
import pytest
from boards.providers.my_provider import MyProvider

@pytest.mark.asyncio
async def test_my_provider_generate_image():
    provider = MyProvider()
    async for result in provider.generate_image("test prompt", {}):
        assert "status" in result
```

## Debugging

### Logging Configuration

```python
# src/boards/config.py
import logging

# Configure logging
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger("boards")
```

### Database Debugging

```python
# Enable SQL logging
from sqlalchemy import create_engine
engine = create_engine(database_url, echo=True)  # Logs all SQL queries
```

### GraphQL Debugging

Visit http://localhost:8000/graphql to use the GraphiQL interface for testing queries and mutations.

## Next Steps

- ðŸ“Š **[Database Migrations](./migrations)** - Learn the migration workflow
- ðŸŽ¨ **[Providers](../providers/overview)** - Integrate AI services  
- ðŸ“± **[GraphQL API](./graphql-api)** - Build the API layer
- ðŸ§ª **[Testing Guide](./testing)** - Write comprehensive tests