[pytest]
# Configuration for generator implementation tests (including live API tests)
# This overrides the root pytest.ini for tests in this directory
#
# Session-scoped event loops are required for live API tests because:
# - Third-party SDKs (fal_client, replicate) use httpx with connection pooling
# - HTTP connections need to close before the event loop closes
# - Function-scoped loops close too early, causing "Event loop is closed" errors
# - Session-scoped loops allow connections to clean up properly across all tests
#
# This does NOT affect other tests (database tests, etc.) which continue to use
# function-scoped loops as defined in the root pytest.ini.

asyncio_default_fixture_loop_scope = session
asyncio_default_test_loop_scope = session

markers =
    live_api: marks tests that make real API calls to external providers (never run by default)
    live_replicate: marks tests that call Replicate API (subset of live_api)
    live_fal: marks tests that call Fal.ai API (subset of live_api)
    live_openai: marks tests that call OpenAI API (subset of live_api)
    live_kie: marks tests that call Kie.ai API (subset of live_api)
